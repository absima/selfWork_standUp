<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <canvas class="animation" onclick="spinTheWheel()"></canvas>
</body>

<script>
  let teamChrisArray = [
    "Arthi",
    "Bruno",
    "David",
    "Fabian",
    "Fi",
    "Jens",
    "Julio",
    "Katrin",
    "Luben",
    "Malaiz",
    "Marina",
    "Samin",
    "Sima",
    "Sivak",
    "Victor",
    "Zan"
  ];
  // "2 pi radian is 360 degrees
  const numberOfSegments = teamChrisArray.length;
  const oneRadian = 180 / Math.PI;
  const oneSegment = 360 / numberOfSegments;

  const studentsPlusDegree = teamChrisArray.map((name, index) => {
    return {
      name: name,
      degrees: index * oneSegment
    }
  });

  const sample = (arr) => arr[Math.floor(Math.random() * arr.length)]

  function spinTheWheel() {
    const randomPerson = sample(studentsPlusDegree);



    // generate a canvas element with document.creatElement("canvas")
    // draw a circle with the names of the students on it using canvas
    // draw a line from the center of the circle to the edge of the circle going up 
    // to the degrees of the randomPerson.degrees

    const canvas = document.querySelector("canvas");

    canvas.width = 500;
    canvas.height = 500;
    const ctx = canvas.getContext("2d");
    ctx.beginPath();
    ctx.arc(250, 250, 200, 0, 2 * Math.PI);
    ctx.stroke();
    ctx.font = "30px Arial";
    ctx.textAlign = "left";
    ctx.textBaseline = "middle";

    studentsPlusDegree.forEach((student) => {
      const radians = student.degrees / oneRadian;
      const y = 250 + 200 * Math.sin(radians);
      const x = 250 + 200 * Math.cos(radians);
      // rotate the text to match segment degrees 
      // give each segment a unique fill color

      ctx.beginPath();
      ctx.moveTo(250, 250);
      ctx.arc(250, 250, 200, 0, radians);
      ctx.lineTo(250, 250);
      ctx.stroke();


      // ctx.save();
      // ctx.translate(y, x);
      // ctx.rotate(radians);
      // // ctx.fillStyle = "red";
      // // ctx.fill()
      // ctx.fillText(student.name, 0, 0);
      // ctx.restore();


      ctx.save();
      ctx.translate(y, x);
      ctx.rotate(-radians);
      if (student.name === randomPerson.name) {
        ctx.fillStyle = "red";
        ctx.fillText(student.name, 0, 0);
        ctx.fillStyle = "black";
      } else {
        ctx.fillText(student.name, 0, 0);
      }

      ctx.restore();
    })


    const fakeNaturalSpins = Math.floor(Math.random() * 10) * 360;
    console.log(fakeNaturalSpins, randomPerson.degrees, fakeNaturalSpins + randomPerson.degrees, randomPerson);

    document.querySelector("canvas").style.transform = `rotate(${(fakeNaturalSpins) + (randomPerson.
      degrees) - 90}deg)`;

    // after the wheel has stopped spinning, show an alert with the name of the person who won
    // redraw the text with the winner's name in red

    setTimeout(() => {
      // ctx.translate(250, 250);
      // move to right edge of canvas
      // ctx.translate(250, 0);
      // rotate to face left
      // ctx.rotate(90 - randomPerson.degrees * Math.PI / 180);
      ctx.fillStyle = "red";
      ctx.fillText(randomPerson.name, 0, 0);

    }, 2000);
  }

  spinTheWheel()

</script>
<style>
  /*  .animation class which has transition: transform 2s ease-in-out; */
  .animation {
    transition: transform 2s ease-in-out;
  }
</style>

</html>